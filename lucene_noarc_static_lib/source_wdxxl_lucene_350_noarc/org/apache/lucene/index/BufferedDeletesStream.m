//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: jar:file:wdxxl_lucene_350.jar!org/apache/lucene/index/BufferedDeletesStream.java
//

#include "J2ObjC_source.h"
#include "java/io/PrintStream.h"
#include "java/lang/Iterable.h"
#include "java/lang/Long.h"
#include "java/lang/Math.h"
#include "java/lang/System.h"
#include "java/lang/Thread.h"
#include "java/util/ArrayList.h"
#include "java/util/Collections.h"
#include "java/util/Comparator.h"
#include "java/util/Date.h"
#include "java/util/List.h"
#include "java/util/concurrent/atomic/AtomicInteger.h"
#include "java/util/concurrent/atomic/AtomicLong.h"
#include "java/util/function/Function.h"
#include "java/util/function/ToDoubleFunction.h"
#include "java/util/function/ToIntFunction.h"
#include "java/util/function/ToLongFunction.h"
#include "org/apache/lucene/index/BufferedDeletesStream.h"
#include "org/apache/lucene/index/CoalescedDeletes.h"
#include "org/apache/lucene/index/FrozenBufferedDeletes.h"
#include "org/apache/lucene/index/IndexWriter.h"
#include "org/apache/lucene/index/SegmentInfo.h"
#include "org/apache/lucene/index/SegmentInfos.h"
#include "org/apache/lucene/index/SegmentReader.h"
#include "org/apache/lucene/index/Term.h"
#include "org/apache/lucene/index/TermDocs.h"
#include "org/apache/lucene/search/DocIdSet.h"
#include "org/apache/lucene/search/DocIdSetIterator.h"
#include "org/apache/lucene/search/Query.h"
#include "org/apache/lucene/search/QueryWrapperFilter.h"

#pragma clang diagnostic ignored "-Wprotocol"

@interface OrgApacheLuceneIndexBufferedDeletesStream () {
 @public
  id<JavaUtilList> deletes_;
  jlong nextGen_;
  OrgApacheLuceneIndexTerm *lastDeleteTerm_;
  JavaIoPrintStream *infoStream_;
  JavaUtilConcurrentAtomicAtomicLong *bytesUsed_;
  JavaUtilConcurrentAtomicAtomicInteger *numTerms_;
  jint messageID_;
}

- (void)messageWithNSString:(NSString *)message;

- (void)pruneWithInt:(jint)count;

- (jlong)applyTermDeletesWithJavaLangIterable:(id<JavaLangIterable>)termsIter
        withOrgApacheLuceneIndexSegmentReader:(OrgApacheLuceneIndexSegmentReader *)reader;

- (jlong)applyQueryDeletesWithJavaLangIterable:(id<JavaLangIterable>)queriesIter
         withOrgApacheLuceneIndexSegmentReader:(OrgApacheLuceneIndexSegmentReader *)reader;

- (jboolean)checkDeleteTermWithOrgApacheLuceneIndexTerm:(OrgApacheLuceneIndexTerm *)term;

- (jboolean)checkDeleteStats;

@end

J2OBJC_FIELD_SETTER(OrgApacheLuceneIndexBufferedDeletesStream, deletes_, id<JavaUtilList>)
J2OBJC_FIELD_SETTER(OrgApacheLuceneIndexBufferedDeletesStream, lastDeleteTerm_, OrgApacheLuceneIndexTerm *)
J2OBJC_FIELD_SETTER(OrgApacheLuceneIndexBufferedDeletesStream, infoStream_, JavaIoPrintStream *)
J2OBJC_FIELD_SETTER(OrgApacheLuceneIndexBufferedDeletesStream, bytesUsed_, JavaUtilConcurrentAtomicAtomicLong *)
J2OBJC_FIELD_SETTER(OrgApacheLuceneIndexBufferedDeletesStream, numTerms_, JavaUtilConcurrentAtomicAtomicInteger *)

inline id<JavaUtilComparator> OrgApacheLuceneIndexBufferedDeletesStream_get_sortByDelGen();
static id<JavaUtilComparator> OrgApacheLuceneIndexBufferedDeletesStream_sortByDelGen;
J2OBJC_STATIC_FIELD_OBJ_FINAL(OrgApacheLuceneIndexBufferedDeletesStream, sortByDelGen, id<JavaUtilComparator>)

__attribute__((unused)) static void OrgApacheLuceneIndexBufferedDeletesStream_messageWithNSString_(OrgApacheLuceneIndexBufferedDeletesStream *self, NSString *message);

__attribute__((unused)) static void OrgApacheLuceneIndexBufferedDeletesStream_pruneWithInt_(OrgApacheLuceneIndexBufferedDeletesStream *self, jint count);

__attribute__((unused)) static jlong OrgApacheLuceneIndexBufferedDeletesStream_applyTermDeletesWithJavaLangIterable_withOrgApacheLuceneIndexSegmentReader_(OrgApacheLuceneIndexBufferedDeletesStream *self, id<JavaLangIterable> termsIter, OrgApacheLuceneIndexSegmentReader *reader);

__attribute__((unused)) static jlong OrgApacheLuceneIndexBufferedDeletesStream_applyQueryDeletesWithJavaLangIterable_withOrgApacheLuceneIndexSegmentReader_(OrgApacheLuceneIndexBufferedDeletesStream *self, id<JavaLangIterable> queriesIter, OrgApacheLuceneIndexSegmentReader *reader);

__attribute__((unused)) static jboolean OrgApacheLuceneIndexBufferedDeletesStream_checkDeleteTermWithOrgApacheLuceneIndexTerm_(OrgApacheLuceneIndexBufferedDeletesStream *self, OrgApacheLuceneIndexTerm *term);

__attribute__((unused)) static jboolean OrgApacheLuceneIndexBufferedDeletesStream_checkDeleteStats(OrgApacheLuceneIndexBufferedDeletesStream *self);

@interface OrgApacheLuceneIndexBufferedDeletesStream_1 : NSObject < JavaUtilComparator >

- (instancetype)init;

- (jint)compareWithId:(OrgApacheLuceneIndexSegmentInfo *)si1
               withId:(OrgApacheLuceneIndexSegmentInfo *)si2;

@end

J2OBJC_EMPTY_STATIC_INIT(OrgApacheLuceneIndexBufferedDeletesStream_1)

__attribute__((unused)) static void OrgApacheLuceneIndexBufferedDeletesStream_1_init(OrgApacheLuceneIndexBufferedDeletesStream_1 *self);

__attribute__((unused)) static OrgApacheLuceneIndexBufferedDeletesStream_1 *new_OrgApacheLuceneIndexBufferedDeletesStream_1_init() NS_RETURNS_RETAINED;

__attribute__((unused)) static OrgApacheLuceneIndexBufferedDeletesStream_1 *create_OrgApacheLuceneIndexBufferedDeletesStream_1_init();

J2OBJC_INITIALIZED_DEFN(OrgApacheLuceneIndexBufferedDeletesStream)

@implementation OrgApacheLuceneIndexBufferedDeletesStream

- (instancetype)initWithInt:(jint)messageID {
  OrgApacheLuceneIndexBufferedDeletesStream_initWithInt_(self, messageID);
  return self;
}

- (void)messageWithNSString:(NSString *)message {
  OrgApacheLuceneIndexBufferedDeletesStream_messageWithNSString_(self, message);
}

- (void)setInfoStreamWithJavaIoPrintStream:(JavaIoPrintStream *)infoStream {
  @synchronized(self) {
    JreStrongAssign(&self->infoStream_, infoStream);
  }
}

- (void)pushWithOrgApacheLuceneIndexFrozenBufferedDeletes:(OrgApacheLuceneIndexFrozenBufferedDeletes *)packet {
  @synchronized(self) {
    JreAssert(([((OrgApacheLuceneIndexFrozenBufferedDeletes *) nil_chk(packet)) any]), (@"org/apache/lucene/index/BufferedDeletesStream.java:86 condition failed: assert packet.any();"));
    JreAssert((OrgApacheLuceneIndexBufferedDeletesStream_checkDeleteStats(self)), (@"org/apache/lucene/index/BufferedDeletesStream.java:87 condition failed: assert checkDeleteStats();"));
    JreAssert((packet->gen_ < nextGen_), (@"org/apache/lucene/index/BufferedDeletesStream.java:88 condition failed: assert packet.gen < nextGen;"));
    [((id<JavaUtilList>) nil_chk(deletes_)) addWithId:packet];
    [((JavaUtilConcurrentAtomicAtomicInteger *) nil_chk(numTerms_)) addAndGetWithInt:packet->numTermDeletes_];
    [((JavaUtilConcurrentAtomicAtomicLong *) nil_chk(bytesUsed_)) addAndGetWithLong:packet->bytesUsed_];
    if (infoStream_ != nil) {
      OrgApacheLuceneIndexBufferedDeletesStream_messageWithNSString_(self, JreStrcat("$@$J$I", @"push deletes ", packet, @" delGen=", packet->gen_, @" packetCount=", [deletes_ size]));
    }
    JreAssert((OrgApacheLuceneIndexBufferedDeletesStream_checkDeleteStats(self)), (@"org/apache/lucene/index/BufferedDeletesStream.java:95 condition failed: assert checkDeleteStats();"));
  }
}

- (void)clear {
  @synchronized(self) {
    [((id<JavaUtilList>) nil_chk(deletes_)) clear];
    nextGen_ = 1;
    [((JavaUtilConcurrentAtomicAtomicInteger *) nil_chk(numTerms_)) setWithInt:0];
    [((JavaUtilConcurrentAtomicAtomicLong *) nil_chk(bytesUsed_)) setWithLong:0];
  }
}

- (jboolean)any {
  return [((JavaUtilConcurrentAtomicAtomicLong *) nil_chk(bytesUsed_)) get] != 0;
}

- (jint)numTerms {
  return [((JavaUtilConcurrentAtomicAtomicInteger *) nil_chk(numTerms_)) get];
}

- (jlong)bytesUsed {
  return [((JavaUtilConcurrentAtomicAtomicLong *) nil_chk(bytesUsed_)) get];
}

- (OrgApacheLuceneIndexBufferedDeletesStream_ApplyDeletesResult *)applyDeletesWithOrgApacheLuceneIndexIndexWriter_ReaderPool:(OrgApacheLuceneIndexIndexWriter_ReaderPool *)readerPool
                                                                                                            withJavaUtilList:(id<JavaUtilList>)infos {
  @synchronized(self) {
    jlong t0 = JavaLangSystem_currentTimeMillis();
    if ([((id<JavaUtilList>) nil_chk(infos)) size] == 0) {
      return create_OrgApacheLuceneIndexBufferedDeletesStream_ApplyDeletesResult_initWithBoolean_withLong_withJavaUtilList_(false, nextGen_++, nil);
    }
    JreAssert((OrgApacheLuceneIndexBufferedDeletesStream_checkDeleteStats(self)), (@"org/apache/lucene/index/BufferedDeletesStream.java:159 condition failed: assert checkDeleteStats();"));
    if (![self any]) {
      OrgApacheLuceneIndexBufferedDeletesStream_messageWithNSString_(self, @"applyDeletes: no deletes; skipping");
      return create_OrgApacheLuceneIndexBufferedDeletesStream_ApplyDeletesResult_initWithBoolean_withLong_withJavaUtilList_(false, nextGen_++, nil);
    }
    if (infoStream_ != nil) {
      OrgApacheLuceneIndexBufferedDeletesStream_messageWithNSString_(self, JreStrcat("$@$I", @"applyDeletes: infos=", infos, @" packetCount=", [((id<JavaUtilList>) nil_chk(deletes_)) size]));
    }
    id<JavaUtilList> infos2 = create_JavaUtilArrayList_init();
    [infos2 addAllWithJavaUtilCollection:infos];
    JavaUtilCollections_sortWithJavaUtilList_withJavaUtilComparator_(infos2, OrgApacheLuceneIndexBufferedDeletesStream_sortByDelGen);
    OrgApacheLuceneIndexCoalescedDeletes *coalescedDeletes = nil;
    jboolean anyNewDeletes = false;
    jint infosIDX = [infos2 size] - 1;
    jint delIDX = [((id<JavaUtilList>) nil_chk(deletes_)) size] - 1;
    id<JavaUtilList> allDeleted = nil;
    while (infosIDX >= 0) {
      OrgApacheLuceneIndexFrozenBufferedDeletes *packet = delIDX >= 0 ? [deletes_ getWithInt:delIDX] : nil;
      OrgApacheLuceneIndexSegmentInfo *info = [infos2 getWithInt:infosIDX];
      jlong segGen = [((OrgApacheLuceneIndexSegmentInfo *) nil_chk(info)) getBufferedDeletesGen];
      if (packet != nil && segGen < packet->gen_) {
        if (coalescedDeletes == nil) {
          coalescedDeletes = create_OrgApacheLuceneIndexCoalescedDeletes_init();
        }
        [coalescedDeletes updateWithOrgApacheLuceneIndexFrozenBufferedDeletes:packet];
        delIDX--;
      }
      else if (packet != nil && segGen == packet->gen_) {
        JreAssert(([((OrgApacheLuceneIndexIndexWriter_ReaderPool *) nil_chk(readerPool)) infoIsLiveWithOrgApacheLuceneIndexSegmentInfo:info]), (@"org/apache/lucene/index/BufferedDeletesStream.java:200 condition failed: assert readerPool.infoIsLive(info);"));
        OrgApacheLuceneIndexSegmentReader *reader = [readerPool getWithOrgApacheLuceneIndexSegmentInfo:info withBoolean:false];
        jint delCount = 0;
        jboolean segAllDeletes;
        @try {
          if (coalescedDeletes != nil) {
            delCount += OrgApacheLuceneIndexBufferedDeletesStream_applyTermDeletesWithJavaLangIterable_withOrgApacheLuceneIndexSegmentReader_(self, [coalescedDeletes termsIterable], reader);
            delCount += OrgApacheLuceneIndexBufferedDeletesStream_applyQueryDeletesWithJavaLangIterable_withOrgApacheLuceneIndexSegmentReader_(self, [coalescedDeletes queriesIterable], reader);
          }
          delCount += OrgApacheLuceneIndexBufferedDeletesStream_applyQueryDeletesWithJavaLangIterable_withOrgApacheLuceneIndexSegmentReader_(self, [packet queriesIterable], reader);
          segAllDeletes = ([((OrgApacheLuceneIndexSegmentReader *) nil_chk(reader)) numDocs] == 0);
        }
        @finally {
          [readerPool release__WithOrgApacheLuceneIndexSegmentReader:reader];
        }
        anyNewDeletes |= (delCount > 0);
        if (segAllDeletes) {
          if (allDeleted == nil) {
            allDeleted = create_JavaUtilArrayList_init();
          }
          [allDeleted addWithId:info];
        }
        if (infoStream_ != nil) {
          OrgApacheLuceneIndexBufferedDeletesStream_messageWithNSString_(self, JreStrcat("$@$J$@$@$I$", @"seg=", info, @" segGen=", segGen, @" segDeletes=[", packet, @"]; coalesced deletes=[", (coalescedDeletes == nil ? @"null" : (id) coalescedDeletes), @"] delCount=", delCount, (segAllDeletes ? @" 100% deleted" : @"")));
        }
        if (coalescedDeletes == nil) {
          coalescedDeletes = create_OrgApacheLuceneIndexCoalescedDeletes_init();
        }
        [coalescedDeletes updateWithOrgApacheLuceneIndexFrozenBufferedDeletes:packet];
        delIDX--;
        infosIDX--;
        [info setBufferedDeletesGenWithLong:nextGen_];
      }
      else {
        if (coalescedDeletes != nil) {
          JreAssert(([((OrgApacheLuceneIndexIndexWriter_ReaderPool *) nil_chk(readerPool)) infoIsLiveWithOrgApacheLuceneIndexSegmentInfo:info]), (@"org/apache/lucene/index/BufferedDeletesStream.java:244 condition failed: assert readerPool.infoIsLive(info);"));
          OrgApacheLuceneIndexSegmentReader *reader = [readerPool getWithOrgApacheLuceneIndexSegmentInfo:info withBoolean:false];
          jint delCount = 0;
          jboolean segAllDeletes;
          @try {
            delCount += OrgApacheLuceneIndexBufferedDeletesStream_applyTermDeletesWithJavaLangIterable_withOrgApacheLuceneIndexSegmentReader_(self, [coalescedDeletes termsIterable], reader);
            delCount += OrgApacheLuceneIndexBufferedDeletesStream_applyQueryDeletesWithJavaLangIterable_withOrgApacheLuceneIndexSegmentReader_(self, [coalescedDeletes queriesIterable], reader);
            segAllDeletes = ([((OrgApacheLuceneIndexSegmentReader *) nil_chk(reader)) numDocs] == 0);
          }
          @finally {
            [readerPool release__WithOrgApacheLuceneIndexSegmentReader:reader];
          }
          anyNewDeletes |= (delCount > 0);
          if (segAllDeletes) {
            if (allDeleted == nil) {
              allDeleted = create_JavaUtilArrayList_init();
            }
            [allDeleted addWithId:info];
          }
          if (infoStream_ != nil) {
            OrgApacheLuceneIndexBufferedDeletesStream_messageWithNSString_(self, JreStrcat("$@$J$@$I$", @"seg=", info, @" segGen=", segGen, @" coalesced deletes=[", (coalescedDeletes == nil ? @"null" : (id) coalescedDeletes), @"] delCount=", delCount, (segAllDeletes ? @" 100% deleted" : @"")));
          }
        }
        [info setBufferedDeletesGenWithLong:nextGen_];
        infosIDX--;
      }
    }
    JreAssert((OrgApacheLuceneIndexBufferedDeletesStream_checkDeleteStats(self)), (@"org/apache/lucene/index/BufferedDeletesStream.java:274 condition failed: assert checkDeleteStats();"));
    if (infoStream_ != nil) {
      OrgApacheLuceneIndexBufferedDeletesStream_messageWithNSString_(self, JreStrcat("$J$", @"applyDeletes took ", (JavaLangSystem_currentTimeMillis() - t0), @" msec"));
    }
    return create_OrgApacheLuceneIndexBufferedDeletesStream_ApplyDeletesResult_initWithBoolean_withLong_withJavaUtilList_(anyNewDeletes, nextGen_++, allDeleted);
  }
}

- (jlong)getNextGen {
  @synchronized(self) {
    return nextGen_++;
  }
}

- (void)pruneWithOrgApacheLuceneIndexSegmentInfos:(OrgApacheLuceneIndexSegmentInfos *)segmentInfos {
  @synchronized(self) {
    JreAssert((OrgApacheLuceneIndexBufferedDeletesStream_checkDeleteStats(self)), (@"org/apache/lucene/index/BufferedDeletesStream.java:292 condition failed: assert checkDeleteStats();"));
    jlong minGen = JavaLangLong_MAX_VALUE;
    for (OrgApacheLuceneIndexSegmentInfo * __strong info in nil_chk(segmentInfos)) {
      minGen = JavaLangMath_minWithLong_withLong_([((OrgApacheLuceneIndexSegmentInfo *) nil_chk(info)) getBufferedDeletesGen], minGen);
    }
    if (infoStream_ != nil) {
      OrgApacheLuceneIndexBufferedDeletesStream_messageWithNSString_(self, JreStrcat("$@$J$I", @"prune sis=", segmentInfos, @" minGen=", minGen, @" packetCount=", [((id<JavaUtilList>) nil_chk(deletes_)) size]));
    }
    jint limit = [((id<JavaUtilList>) nil_chk(deletes_)) size];
    for (jint delIDX = 0; delIDX < limit; delIDX++) {
      if (((OrgApacheLuceneIndexFrozenBufferedDeletes *) nil_chk([deletes_ getWithInt:delIDX]))->gen_ >= minGen) {
        OrgApacheLuceneIndexBufferedDeletesStream_pruneWithInt_(self, delIDX);
        JreAssert((OrgApacheLuceneIndexBufferedDeletesStream_checkDeleteStats(self)), (@"org/apache/lucene/index/BufferedDeletesStream.java:306 condition failed: assert checkDeleteStats();"));
        return;
      }
    }
    OrgApacheLuceneIndexBufferedDeletesStream_pruneWithInt_(self, limit);
    JreAssert((![self any]), (@"org/apache/lucene/index/BufferedDeletesStream.java:313 condition failed: assert !any();"));
    JreAssert((OrgApacheLuceneIndexBufferedDeletesStream_checkDeleteStats(self)), (@"org/apache/lucene/index/BufferedDeletesStream.java:314 condition failed: assert checkDeleteStats();"));
  }
}

- (void)pruneWithInt:(jint)count {
  OrgApacheLuceneIndexBufferedDeletesStream_pruneWithInt_(self, count);
}

- (jlong)applyTermDeletesWithJavaLangIterable:(id<JavaLangIterable>)termsIter
        withOrgApacheLuceneIndexSegmentReader:(OrgApacheLuceneIndexSegmentReader *)reader {
  return OrgApacheLuceneIndexBufferedDeletesStream_applyTermDeletesWithJavaLangIterable_withOrgApacheLuceneIndexSegmentReader_(self, termsIter, reader);
}

- (jlong)applyQueryDeletesWithJavaLangIterable:(id<JavaLangIterable>)queriesIter
         withOrgApacheLuceneIndexSegmentReader:(OrgApacheLuceneIndexSegmentReader *)reader {
  return OrgApacheLuceneIndexBufferedDeletesStream_applyQueryDeletesWithJavaLangIterable_withOrgApacheLuceneIndexSegmentReader_(self, queriesIter, reader);
}

- (jboolean)checkDeleteTermWithOrgApacheLuceneIndexTerm:(OrgApacheLuceneIndexTerm *)term {
  return OrgApacheLuceneIndexBufferedDeletesStream_checkDeleteTermWithOrgApacheLuceneIndexTerm_(self, term);
}

- (jboolean)checkDeleteStats {
  return OrgApacheLuceneIndexBufferedDeletesStream_checkDeleteStats(self);
}

- (void)dealloc {
  RELEASE_(deletes_);
  RELEASE_(lastDeleteTerm_);
  RELEASE_(infoStream_);
  RELEASE_(bytesUsed_);
  RELEASE_(numTerms_);
  [super dealloc];
}

+ (const J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { NULL, NULL, 0x1, -1, 0, -1, -1, -1, -1 },
    { NULL, "V", 0x22, 1, 2, -1, -1, -1, -1 },
    { NULL, "V", 0x21, 3, 4, -1, -1, -1, -1 },
    { NULL, "V", 0x21, 5, 6, -1, -1, -1, -1 },
    { NULL, "V", 0x21, -1, -1, -1, -1, -1, -1 },
    { NULL, "Z", 0x1, -1, -1, -1, -1, -1, -1 },
    { NULL, "I", 0x1, -1, -1, -1, -1, -1, -1 },
    { NULL, "J", 0x1, -1, -1, -1, -1, -1, -1 },
    { NULL, "LOrgApacheLuceneIndexBufferedDeletesStream_ApplyDeletesResult;", 0x21, 7, 8, 9, 10, -1, -1 },
    { NULL, "J", 0x21, -1, -1, -1, -1, -1, -1 },
    { NULL, "V", 0x21, 11, 12, -1, -1, -1, -1 },
    { NULL, "V", 0x22, 11, 0, -1, -1, -1, -1 },
    { NULL, "J", 0x22, 13, 14, 9, 15, -1, -1 },
    { NULL, "J", 0x22, 16, 14, 9, 17, -1, -1 },
    { NULL, "Z", 0x2, 18, 19, -1, -1, -1, -1 },
    { NULL, "Z", 0x2, -1, -1, -1, -1, -1, -1 },
  };
  #pragma clang diagnostic push
  #pragma clang diagnostic ignored "-Wobjc-multiple-method-names"
  methods[0].selector = @selector(initWithInt:);
  methods[1].selector = @selector(messageWithNSString:);
  methods[2].selector = @selector(setInfoStreamWithJavaIoPrintStream:);
  methods[3].selector = @selector(pushWithOrgApacheLuceneIndexFrozenBufferedDeletes:);
  methods[4].selector = @selector(clear);
  methods[5].selector = @selector(any);
  methods[6].selector = @selector(numTerms);
  methods[7].selector = @selector(bytesUsed);
  methods[8].selector = @selector(applyDeletesWithOrgApacheLuceneIndexIndexWriter_ReaderPool:withJavaUtilList:);
  methods[9].selector = @selector(getNextGen);
  methods[10].selector = @selector(pruneWithOrgApacheLuceneIndexSegmentInfos:);
  methods[11].selector = @selector(pruneWithInt:);
  methods[12].selector = @selector(applyTermDeletesWithJavaLangIterable:withOrgApacheLuceneIndexSegmentReader:);
  methods[13].selector = @selector(applyQueryDeletesWithJavaLangIterable:withOrgApacheLuceneIndexSegmentReader:);
  methods[14].selector = @selector(checkDeleteTermWithOrgApacheLuceneIndexTerm:);
  methods[15].selector = @selector(checkDeleteStats);
  #pragma clang diagnostic pop
  static const J2ObjcFieldInfo fields[] = {
    { "deletes_", "LJavaUtilList;", .constantValue.asLong = 0, 0x12, -1, -1, 20, -1 },
    { "nextGen_", "J", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "lastDeleteTerm_", "LOrgApacheLuceneIndexTerm;", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "infoStream_", "LJavaIoPrintStream;", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "bytesUsed_", "LJavaUtilConcurrentAtomicAtomicLong;", .constantValue.asLong = 0, 0x12, -1, -1, -1, -1 },
    { "numTerms_", "LJavaUtilConcurrentAtomicAtomicInteger;", .constantValue.asLong = 0, 0x12, -1, -1, -1, -1 },
    { "messageID_", "I", .constantValue.asLong = 0, 0x12, -1, -1, -1, -1 },
    { "sortByDelGen", "LJavaUtilComparator;", .constantValue.asLong = 0, 0x1a, -1, 21, 22, -1 },
  };
  static const void *ptrTable[] = { "I", "message", "LNSString;", "setInfoStream", "LJavaIoPrintStream;", "push", "LOrgApacheLuceneIndexFrozenBufferedDeletes;", "applyDeletes", "LOrgApacheLuceneIndexIndexWriter_ReaderPool;LJavaUtilList;", "LJavaIoIOException;", "(Lorg/apache/lucene/index/IndexWriter$ReaderPool;Ljava/util/List<Lorg/apache/lucene/index/SegmentInfo;>;)Lorg/apache/lucene/index/BufferedDeletesStream$ApplyDeletesResult;", "prune", "LOrgApacheLuceneIndexSegmentInfos;", "applyTermDeletes", "LJavaLangIterable;LOrgApacheLuceneIndexSegmentReader;", "(Ljava/lang/Iterable<Lorg/apache/lucene/index/Term;>;Lorg/apache/lucene/index/SegmentReader;)J", "applyQueryDeletes", "(Ljava/lang/Iterable<Lorg/apache/lucene/index/BufferedDeletesStream$QueryAndLimit;>;Lorg/apache/lucene/index/SegmentReader;)J", "checkDeleteTerm", "LOrgApacheLuceneIndexTerm;", "Ljava/util/List<Lorg/apache/lucene/index/FrozenBufferedDeletes;>;", &OrgApacheLuceneIndexBufferedDeletesStream_sortByDelGen, "Ljava/util/Comparator<Lorg/apache/lucene/index/SegmentInfo;>;", "LOrgApacheLuceneIndexBufferedDeletesStream_ApplyDeletesResult;LOrgApacheLuceneIndexBufferedDeletesStream_QueryAndLimit;" };
  static const J2ObjcClassInfo _OrgApacheLuceneIndexBufferedDeletesStream = { "BufferedDeletesStream", "org.apache.lucene.index", ptrTable, methods, fields, 7, 0x0, 16, 8, -1, 23, -1, -1, -1 };
  return &_OrgApacheLuceneIndexBufferedDeletesStream;
}

+ (void)initialize {
  if (self == [OrgApacheLuceneIndexBufferedDeletesStream class]) {
    JreStrongAssignAndConsume(&OrgApacheLuceneIndexBufferedDeletesStream_sortByDelGen, new_OrgApacheLuceneIndexBufferedDeletesStream_1_init());
    J2OBJC_SET_INITIALIZED(OrgApacheLuceneIndexBufferedDeletesStream)
  }
}

@end

void OrgApacheLuceneIndexBufferedDeletesStream_initWithInt_(OrgApacheLuceneIndexBufferedDeletesStream *self, jint messageID) {
  NSObject_init(self);
  JreStrongAssignAndConsume(&self->deletes_, new_JavaUtilArrayList_init());
  self->nextGen_ = 1;
  JreStrongAssignAndConsume(&self->bytesUsed_, new_JavaUtilConcurrentAtomicAtomicLong_init());
  JreStrongAssignAndConsume(&self->numTerms_, new_JavaUtilConcurrentAtomicAtomicInteger_init());
  self->messageID_ = messageID;
}

OrgApacheLuceneIndexBufferedDeletesStream *new_OrgApacheLuceneIndexBufferedDeletesStream_initWithInt_(jint messageID) {
  J2OBJC_NEW_IMPL(OrgApacheLuceneIndexBufferedDeletesStream, initWithInt_, messageID)
}

OrgApacheLuceneIndexBufferedDeletesStream *create_OrgApacheLuceneIndexBufferedDeletesStream_initWithInt_(jint messageID) {
  J2OBJC_CREATE_IMPL(OrgApacheLuceneIndexBufferedDeletesStream, initWithInt_, messageID)
}

void OrgApacheLuceneIndexBufferedDeletesStream_messageWithNSString_(OrgApacheLuceneIndexBufferedDeletesStream *self, NSString *message) {
  @synchronized(self) {
    if (self->infoStream_ != nil) {
      [self->infoStream_ printlnWithNSString:JreStrcat("$I$@$$$$", @"BD ", self->messageID_, @" [", create_JavaUtilDate_init(), @"; ", [((JavaLangThread *) nil_chk(JavaLangThread_currentThread())) getName], @"]: ", message)];
    }
  }
}

void OrgApacheLuceneIndexBufferedDeletesStream_pruneWithInt_(OrgApacheLuceneIndexBufferedDeletesStream *self, jint count) {
  @synchronized(self) {
    if (count > 0) {
      if (self->infoStream_ != nil) {
        OrgApacheLuceneIndexBufferedDeletesStream_messageWithNSString_(self, JreStrcat("$I$I$", @"pruneDeletes: prune ", count, @" packets; ", ([((id<JavaUtilList>) nil_chk(self->deletes_)) size] - count), @" packets remain"));
      }
      for (jint delIDX = 0; delIDX < count; delIDX++) {
        OrgApacheLuceneIndexFrozenBufferedDeletes *packet = [((id<JavaUtilList>) nil_chk(self->deletes_)) getWithInt:delIDX];
        [((JavaUtilConcurrentAtomicAtomicInteger *) nil_chk(self->numTerms_)) addAndGetWithInt:-((OrgApacheLuceneIndexFrozenBufferedDeletes *) nil_chk(packet))->numTermDeletes_];
        JreAssert(([self->numTerms_ get] >= 0), (@"org/apache/lucene/index/BufferedDeletesStream.java:325 condition failed: assert numTerms.get() >= 0;"));
        [((JavaUtilConcurrentAtomicAtomicLong *) nil_chk(self->bytesUsed_)) addAndGetWithLong:-packet->bytesUsed_];
        JreAssert(([self->bytesUsed_ get] >= 0), (@"org/apache/lucene/index/BufferedDeletesStream.java:327 condition failed: assert bytesUsed.get() >= 0;"));
      }
      [((id<JavaUtilList>) nil_chk([((id<JavaUtilList>) nil_chk(self->deletes_)) subListWithInt:0 withInt:count])) clear];
    }
  }
}

jlong OrgApacheLuceneIndexBufferedDeletesStream_applyTermDeletesWithJavaLangIterable_withOrgApacheLuceneIndexSegmentReader_(OrgApacheLuceneIndexBufferedDeletesStream *self, id<JavaLangIterable> termsIter, OrgApacheLuceneIndexSegmentReader *reader) {
  @synchronized(self) {
    jlong delCount = 0;
    JreAssert((OrgApacheLuceneIndexBufferedDeletesStream_checkDeleteTermWithOrgApacheLuceneIndexTerm_(self, nil)), (@"org/apache/lucene/index/BufferedDeletesStream.java:337 condition failed: assert checkDeleteTerm(null);"));
    id<OrgApacheLuceneIndexTermDocs> docs = [((OrgApacheLuceneIndexSegmentReader *) nil_chk(reader)) termDocs];
    for (OrgApacheLuceneIndexTerm * __strong term in nil_chk(termsIter)) {
      JreAssert((OrgApacheLuceneIndexBufferedDeletesStream_checkDeleteTermWithOrgApacheLuceneIndexTerm_(self, term)), (@"org/apache/lucene/index/BufferedDeletesStream.java:346 condition failed: assert checkDeleteTerm(term);"));
      [((id<OrgApacheLuceneIndexTermDocs>) nil_chk(docs)) seekWithOrgApacheLuceneIndexTerm:term];
      while ([docs next]) {
        jint docID = [docs doc];
        [reader deleteDocumentWithInt:docID];
        delCount++;
      }
    }
    return delCount;
  }
}

jlong OrgApacheLuceneIndexBufferedDeletesStream_applyQueryDeletesWithJavaLangIterable_withOrgApacheLuceneIndexSegmentReader_(OrgApacheLuceneIndexBufferedDeletesStream *self, id<JavaLangIterable> queriesIter, OrgApacheLuceneIndexSegmentReader *reader) {
  @synchronized(self) {
    jlong delCount = 0;
    for (OrgApacheLuceneIndexBufferedDeletesStream_QueryAndLimit * __strong ent in nil_chk(queriesIter)) {
      OrgApacheLuceneSearchQuery *query = ((OrgApacheLuceneIndexBufferedDeletesStream_QueryAndLimit *) nil_chk(ent))->query_;
      jint limit = ent->limit_;
      OrgApacheLuceneSearchDocIdSet *docs = [create_OrgApacheLuceneSearchQueryWrapperFilter_initWithOrgApacheLuceneSearchQuery_(query) getDocIdSetWithOrgApacheLuceneIndexIndexReader:reader];
      if (docs != nil) {
        OrgApacheLuceneSearchDocIdSetIterator *it = [docs iterator];
        if (it != nil) {
          while (true) {
            jint doc = [it nextDoc];
            if (doc >= limit) break;
            [((OrgApacheLuceneIndexSegmentReader *) nil_chk(reader)) deleteDocumentWithInt:doc];
            delCount++;
          }
        }
      }
    }
    return delCount;
  }
}

jboolean OrgApacheLuceneIndexBufferedDeletesStream_checkDeleteTermWithOrgApacheLuceneIndexTerm_(OrgApacheLuceneIndexBufferedDeletesStream *self, OrgApacheLuceneIndexTerm *term) {
  if (term != nil) {
    JreAssert((self->lastDeleteTerm_ == nil || [term compareToWithId:self->lastDeleteTerm_] > 0), (JreStrcat("$@$@", @"lastTerm=", self->lastDeleteTerm_, @" vs term=", term)));
  }
  JreStrongAssign(&self->lastDeleteTerm_, term == nil ? nil : create_OrgApacheLuceneIndexTerm_initWithNSString_withNSString_([term field], [term text]));
  return true;
}

jboolean OrgApacheLuceneIndexBufferedDeletesStream_checkDeleteStats(OrgApacheLuceneIndexBufferedDeletesStream *self) {
  jint numTerms2 = 0;
  jlong bytesUsed2 = 0;
  for (OrgApacheLuceneIndexFrozenBufferedDeletes * __strong packet in nil_chk(self->deletes_)) {
    numTerms2 += ((OrgApacheLuceneIndexFrozenBufferedDeletes *) nil_chk(packet))->numTermDeletes_;
    bytesUsed2 += packet->bytesUsed_;
  }
  JreAssert((numTerms2 == [((JavaUtilConcurrentAtomicAtomicInteger *) nil_chk(self->numTerms_)) get]), (JreStrcat("$I$I", @"numTerms2=", numTerms2, @" vs ", [self->numTerms_ get])));
  JreAssert((bytesUsed2 == [((JavaUtilConcurrentAtomicAtomicLong *) nil_chk(self->bytesUsed_)) get]), (JreStrcat("$J$@", @"bytesUsed2=", bytesUsed2, @" vs ", self->bytesUsed_)));
  return true;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheLuceneIndexBufferedDeletesStream)

@implementation OrgApacheLuceneIndexBufferedDeletesStream_ApplyDeletesResult

- (instancetype)initWithBoolean:(jboolean)anyDeletes
                       withLong:(jlong)gen
               withJavaUtilList:(id<JavaUtilList>)allDeleted {
  OrgApacheLuceneIndexBufferedDeletesStream_ApplyDeletesResult_initWithBoolean_withLong_withJavaUtilList_(self, anyDeletes, gen, allDeleted);
  return self;
}

- (void)dealloc {
  RELEASE_(allDeleted_);
  [super dealloc];
}

+ (const J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { NULL, NULL, 0x0, -1, 0, -1, 1, -1, -1 },
  };
  #pragma clang diagnostic push
  #pragma clang diagnostic ignored "-Wobjc-multiple-method-names"
  methods[0].selector = @selector(initWithBoolean:withLong:withJavaUtilList:);
  #pragma clang diagnostic pop
  static const J2ObjcFieldInfo fields[] = {
    { "anyDeletes_", "Z", .constantValue.asLong = 0, 0x11, -1, -1, -1, -1 },
    { "gen_", "J", .constantValue.asLong = 0, 0x11, -1, -1, -1, -1 },
    { "allDeleted_", "LJavaUtilList;", .constantValue.asLong = 0, 0x11, -1, -1, 2, -1 },
  };
  static const void *ptrTable[] = { "ZJLJavaUtilList;", "(ZJLjava/util/List<Lorg/apache/lucene/index/SegmentInfo;>;)V", "Ljava/util/List<Lorg/apache/lucene/index/SegmentInfo;>;", "LOrgApacheLuceneIndexBufferedDeletesStream;" };
  static const J2ObjcClassInfo _OrgApacheLuceneIndexBufferedDeletesStream_ApplyDeletesResult = { "ApplyDeletesResult", "org.apache.lucene.index", ptrTable, methods, fields, 7, 0x9, 1, 3, 3, -1, -1, -1, -1 };
  return &_OrgApacheLuceneIndexBufferedDeletesStream_ApplyDeletesResult;
}

@end

void OrgApacheLuceneIndexBufferedDeletesStream_ApplyDeletesResult_initWithBoolean_withLong_withJavaUtilList_(OrgApacheLuceneIndexBufferedDeletesStream_ApplyDeletesResult *self, jboolean anyDeletes, jlong gen, id<JavaUtilList> allDeleted) {
  NSObject_init(self);
  self->anyDeletes_ = anyDeletes;
  self->gen_ = gen;
  JreStrongAssign(&self->allDeleted_, allDeleted);
}

OrgApacheLuceneIndexBufferedDeletesStream_ApplyDeletesResult *new_OrgApacheLuceneIndexBufferedDeletesStream_ApplyDeletesResult_initWithBoolean_withLong_withJavaUtilList_(jboolean anyDeletes, jlong gen, id<JavaUtilList> allDeleted) {
  J2OBJC_NEW_IMPL(OrgApacheLuceneIndexBufferedDeletesStream_ApplyDeletesResult, initWithBoolean_withLong_withJavaUtilList_, anyDeletes, gen, allDeleted)
}

OrgApacheLuceneIndexBufferedDeletesStream_ApplyDeletesResult *create_OrgApacheLuceneIndexBufferedDeletesStream_ApplyDeletesResult_initWithBoolean_withLong_withJavaUtilList_(jboolean anyDeletes, jlong gen, id<JavaUtilList> allDeleted) {
  J2OBJC_CREATE_IMPL(OrgApacheLuceneIndexBufferedDeletesStream_ApplyDeletesResult, initWithBoolean_withLong_withJavaUtilList_, anyDeletes, gen, allDeleted)
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheLuceneIndexBufferedDeletesStream_ApplyDeletesResult)

@implementation OrgApacheLuceneIndexBufferedDeletesStream_1

J2OBJC_IGNORE_DESIGNATED_BEGIN
- (instancetype)init {
  OrgApacheLuceneIndexBufferedDeletesStream_1_init(self);
  return self;
}
J2OBJC_IGNORE_DESIGNATED_END

- (jint)compareWithId:(OrgApacheLuceneIndexSegmentInfo *)si1
               withId:(OrgApacheLuceneIndexSegmentInfo *)si2 {
  jlong cmp = [((OrgApacheLuceneIndexSegmentInfo *) nil_chk(si1)) getBufferedDeletesGen] - [((OrgApacheLuceneIndexSegmentInfo *) nil_chk(si2)) getBufferedDeletesGen];
  if (cmp > 0) {
    return 1;
  }
  else if (cmp < 0) {
    return -1;
  }
  else {
    return 0;
  }
}

- (id<JavaUtilComparator>)reversed {
  return JavaUtilComparator_reversed(self);
}

- (id<JavaUtilComparator>)thenComparingWithJavaUtilComparator:(id<JavaUtilComparator>)arg0 {
  return JavaUtilComparator_thenComparingWithJavaUtilComparator_(self, arg0);
}

- (id<JavaUtilComparator>)thenComparingWithJavaUtilFunctionFunction:(id<JavaUtilFunctionFunction>)arg0
                                             withJavaUtilComparator:(id<JavaUtilComparator>)arg1 {
  return JavaUtilComparator_thenComparingWithJavaUtilFunctionFunction_withJavaUtilComparator_(self, arg0, arg1);
}

- (id<JavaUtilComparator>)thenComparingWithJavaUtilFunctionFunction:(id<JavaUtilFunctionFunction>)arg0 {
  return JavaUtilComparator_thenComparingWithJavaUtilFunctionFunction_(self, arg0);
}

- (id<JavaUtilComparator>)thenComparingIntWithJavaUtilFunctionToIntFunction:(id<JavaUtilFunctionToIntFunction>)arg0 {
  return JavaUtilComparator_thenComparingIntWithJavaUtilFunctionToIntFunction_(self, arg0);
}

- (id<JavaUtilComparator>)thenComparingLongWithJavaUtilFunctionToLongFunction:(id<JavaUtilFunctionToLongFunction>)arg0 {
  return JavaUtilComparator_thenComparingLongWithJavaUtilFunctionToLongFunction_(self, arg0);
}

- (id<JavaUtilComparator>)thenComparingDoubleWithJavaUtilFunctionToDoubleFunction:(id<JavaUtilFunctionToDoubleFunction>)arg0 {
  return JavaUtilComparator_thenComparingDoubleWithJavaUtilFunctionToDoubleFunction_(self, arg0);
}

+ (const J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { NULL, NULL, 0x0, -1, -1, -1, -1, -1, -1 },
    { NULL, "I", 0x1, 0, 1, -1, -1, -1, -1 },
  };
  #pragma clang diagnostic push
  #pragma clang diagnostic ignored "-Wobjc-multiple-method-names"
  methods[0].selector = @selector(init);
  methods[1].selector = @selector(compareWithId:withId:);
  #pragma clang diagnostic pop
  static const void *ptrTable[] = { "compare", "LOrgApacheLuceneIndexSegmentInfo;LOrgApacheLuceneIndexSegmentInfo;", "LOrgApacheLuceneIndexBufferedDeletesStream;", "Ljava/lang/Object;Ljava/util/Comparator<Lorg/apache/lucene/index/SegmentInfo;>;" };
  static const J2ObjcClassInfo _OrgApacheLuceneIndexBufferedDeletesStream_1 = { "", "org.apache.lucene.index", ptrTable, methods, NULL, 7, 0x8018, 2, 0, 2, -1, -1, 3, -1 };
  return &_OrgApacheLuceneIndexBufferedDeletesStream_1;
}

@end

void OrgApacheLuceneIndexBufferedDeletesStream_1_init(OrgApacheLuceneIndexBufferedDeletesStream_1 *self) {
  NSObject_init(self);
}

OrgApacheLuceneIndexBufferedDeletesStream_1 *new_OrgApacheLuceneIndexBufferedDeletesStream_1_init() {
  J2OBJC_NEW_IMPL(OrgApacheLuceneIndexBufferedDeletesStream_1, init)
}

OrgApacheLuceneIndexBufferedDeletesStream_1 *create_OrgApacheLuceneIndexBufferedDeletesStream_1_init() {
  J2OBJC_CREATE_IMPL(OrgApacheLuceneIndexBufferedDeletesStream_1, init)
}

@implementation OrgApacheLuceneIndexBufferedDeletesStream_QueryAndLimit

- (instancetype)initWithOrgApacheLuceneSearchQuery:(OrgApacheLuceneSearchQuery *)query
                                           withInt:(jint)limit {
  OrgApacheLuceneIndexBufferedDeletesStream_QueryAndLimit_initWithOrgApacheLuceneSearchQuery_withInt_(self, query, limit);
  return self;
}

- (void)dealloc {
  RELEASE_(query_);
  [super dealloc];
}

+ (const J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { NULL, NULL, 0x1, -1, 0, -1, -1, -1, -1 },
  };
  #pragma clang diagnostic push
  #pragma clang diagnostic ignored "-Wobjc-multiple-method-names"
  methods[0].selector = @selector(initWithOrgApacheLuceneSearchQuery:withInt:);
  #pragma clang diagnostic pop
  static const J2ObjcFieldInfo fields[] = {
    { "query_", "LOrgApacheLuceneSearchQuery;", .constantValue.asLong = 0, 0x11, -1, -1, -1, -1 },
    { "limit_", "I", .constantValue.asLong = 0, 0x11, -1, -1, -1, -1 },
  };
  static const void *ptrTable[] = { "LOrgApacheLuceneSearchQuery;I", "LOrgApacheLuceneIndexBufferedDeletesStream;" };
  static const J2ObjcClassInfo _OrgApacheLuceneIndexBufferedDeletesStream_QueryAndLimit = { "QueryAndLimit", "org.apache.lucene.index", ptrTable, methods, fields, 7, 0x9, 1, 2, 1, -1, -1, -1, -1 };
  return &_OrgApacheLuceneIndexBufferedDeletesStream_QueryAndLimit;
}

@end

void OrgApacheLuceneIndexBufferedDeletesStream_QueryAndLimit_initWithOrgApacheLuceneSearchQuery_withInt_(OrgApacheLuceneIndexBufferedDeletesStream_QueryAndLimit *self, OrgApacheLuceneSearchQuery *query, jint limit) {
  NSObject_init(self);
  JreStrongAssign(&self->query_, query);
  self->limit_ = limit;
}

OrgApacheLuceneIndexBufferedDeletesStream_QueryAndLimit *new_OrgApacheLuceneIndexBufferedDeletesStream_QueryAndLimit_initWithOrgApacheLuceneSearchQuery_withInt_(OrgApacheLuceneSearchQuery *query, jint limit) {
  J2OBJC_NEW_IMPL(OrgApacheLuceneIndexBufferedDeletesStream_QueryAndLimit, initWithOrgApacheLuceneSearchQuery_withInt_, query, limit)
}

OrgApacheLuceneIndexBufferedDeletesStream_QueryAndLimit *create_OrgApacheLuceneIndexBufferedDeletesStream_QueryAndLimit_initWithOrgApacheLuceneSearchQuery_withInt_(OrgApacheLuceneSearchQuery *query, jint limit) {
  J2OBJC_CREATE_IMPL(OrgApacheLuceneIndexBufferedDeletesStream_QueryAndLimit, initWithOrgApacheLuceneSearchQuery_withInt_, query, limit)
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheLuceneIndexBufferedDeletesStream_QueryAndLimit)
